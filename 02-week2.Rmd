

# Week 2  

```{r,echo=F}
knitr::opts_chunk$set(message = F, warning = F,cache=T)
```

## 政府公开数据 




### 中国有关条例和法规  

1. [《中华人民共和国统计法》](http://www.stats.gov.cn/zjtj/tjfg/tjfl/200906/t20090629_8791.html)：1983 年 12 月 8 日通过，上次修订于 2009 年 6 月 27 日

部分相关条目：

>　第二十条　县级以上人民政府统计机构和有关部门以及乡、镇人民政府，应当按照国家有关规定建立统计资料的保存、管理制度，建立健全统计信息共享机制。

> 第二十四条　县级以上人民政府有关部门统计调查取得的统计资料，由本部门按照国家有关规定公布。

> 第二十六条　县级以上人民政府统计机构和有关部门统计调查取得的统计资料，除依法应当保密的外，应当及时公开，供社会公众查询。  

2. [《中华人民共和国政府信息公开条例》](http://www.cbdio.com/BigData/2019-04/16/content_6081484.htm): 2007年4月5日中华人民共和国国务院令第492号公布　2019年4月3日中华人民共和国国务院令第711号修订

部分相关条目：

> 第十九条　对涉及公众利益调整、需要公众广泛知晓或者需要公众参与决策的政府信息，行政机关应当主动公开。

> 第二十条　行政机关应当依照本条例第十九条的规定，主动公开本行政机关的下列政府信息：

> （一）行政法规、规章和规范性文件；

> （二）机关职能、机构设置、办公地址、办公时间、联系方式、负责人姓名；

> （三）国民经济和社会发展规划、专项规划、区域规划及相关政策；

> （四）国民经济和社会发展统计信息；

> （五）办理行政许可和其他对外管理服务事项的依据、条件、程序以及办理结果；

> （六）实施行政处罚、行政强制的依据、条件、程序以及本行政机关认为具有一定社会影响的行政处罚决定；

> （七）财政预算、决算信息；

> （八）行政事业性收费项目及其依据、标准；

> （九）政府集中采购项目的目录、标准及实施情况；

> （十）重大建设项目的批准和实施情况；

> （十一）扶贫、教育、医疗、社会保障、促进就业等方面的政策、措施及其实施情况；

> （十二）突发公共事件的应急预案、预警信息及应对情况；

> （十三）环境保护、公共卫生、安全生产、食品药品、产品质量的监督检查情况；

> （十四）公务员招考的职位、名额、报考条件等事项以及录用结果；

> （十五）法律、法规、规章和国家有关规定规定应当主动公开的其他政府信息。

3. [《贵州省大数据发展应用促进条例》](http://www.cbdio.com/BigData/2016-01/18/content_4501549.htm)：2016 年 3 月 1 日施行，中国首部大数据地方法规

部分相关条目：

> 第二十四条 省人民政府按照统一标准、依法管理，主动提供、无偿服务，便捷高效、安全可靠的原则，制定全省公共数据共享开放措施，推动公共数据率先共享开放。

> 第二十六条 全省统一的大数据平台（以下简称“云上贵州”）汇集、存储、共享、开放全省公共数据及其他数据。鼓励其他信息系统向“云上贵州”迁移，其他数据汇集、存储在“云上贵州”并与他人共享、向社会开放。

> 第二十七条 实行公共数据开放负面清单制度。除法律法规另有规定外，公共数据应当向社会开放；依法不能向社会开放的公共数据，目录应当向社会公布。依法不能向社会开放的公共数据，涉及特定公民、法人和其他组织重大利益关系的，经申请可以向该特定对象开放。

> 第二十八条 公共数据共享开放，应当符合统一的格式标准，内容应当真实、准确、完整。通过共享开放获取的公共数据，与纸质文书原件具有同等效力。

> 第三十条 鼓励单位和个人对共享开放的数据进行分析、挖掘、研究，开展大数据开发和创新应用。

4. [《上海市公共数据开放暂行办法》](http://www.shanghai.gov.cn/nw2/nw2314/nw2319/nw12344/u26aw62638.html ): 2019 年 10 月 1 日起开始施行

部分相关条目：

> 第三条（定义）:本办法所称公共数据，是指本市各级行政机关以及履行公共管理和服务职能的事业单位（以下统称公共管理和服务机构）在依法履职过程中，采集和产生的各类数据资源。本办法所称公共数据开放，是指公共管理和服务机构在公共数据范围内，面向社会提供具备原始性、可机器读取、可供社会化再利用的数据集的公共服务。

> 第十条（开放重点）:市经济信息化部门应当根据本市经济社会发展需要，确定年度公共数据开放重点。与民生紧密相关、社会迫切需要、行业增值潜力显著和产业战略意义重大的公共数据，应当优先纳入公共数据开放重点。  

> 第十六条（数据质量）:数据开放主体应当按照相关技术标准和要求，对列入开放清单的公共数据（以下简称开放数据）进行整理、清洗、脱敏、格式转换等处理，并根据开放清单明确的更新频率，及时更新数据。

> 　第十七条（开放平台）:市大数据中心应当依托市大数据资源平台建设开放平台。数据开放主体应当通过开放平台开放公共数据，原则上不再新建独立的开放渠道。已经建成的开放渠道，应当按照有关规定进行整合、归并，将其纳入开放平台。


### 国内外政府开放数据平台

1. [中华人民共和国国家统计局](http://www.stats.gov.cn/tjsj/) 和地方统计局，如[北京市统计局] (http://www.bjstats.gov.cn/tjsj/) 、[上海市公共数据开放平台](https://trial.data.sh.gov.cn/)、[云上贵州](https://www.gzdata.com.cn/)、[台湾省政府数据开放平台](https://data.gov.tw/)  

2. [国家统计局建立的国家数据库](http://data.stats.gov.cn/index.htm)

3. [CIEC](https://www.ceicdata.com/zh-hans): 全球大部分国家的宏微观经济数据

4. [联合国统计司](https://unstats.un.org/home/)

5. [美国国家统计局](https://www.census.gov) 以及美国各个部门下属的统计局： 如[美国劳工部统计局](https://www.bls.gov/)，各州部门的统计资料，如[得克萨斯州司法部](https://www.tdcj.texas.gov/ks_offender.html)  

6. [世界银行发展指标数据库(WDI)](http://datatopics.worldbank.org/world-development-indicators/): 涵盖人口、社会、环境、经济金融等多领域国家级数据  



## 季度 GDP 增速  

为排除价格波动的影响，统计指标选取真实 GDP (**国内生产总值(不变价)**，当季值(亿元))。  

数据页面：
![](images\govstats.png)

![](images\gdp.png)

![](images\index.png)

加载必要的 package ： 

```{r, message = F}
library(tidyverse)
library(readxl)
```


导入表中计算所需的数据
```{r}
gdp <- read_excel("data/gdp.xlsx",
                  skip = 2, 
                  n_max = 1)
```

用 `gather()` 函数将数据集化宽为长


```{r}
gdp <- gdp %>% 
  select(-1) %>%
  gather(key = Season, value = GDP, .)
## 为方便之后计算，颠倒列的顺序
gdp$Season <- rev(gdp$Season)
gdp$GDP <- rev(gdp$GDP)
knitr::kable(gdp)
```

考虑到基期年份的影响(2011 - 2015年数据按 2010年价格计算，2016 年及以后各季度数据按2015年价格计算)，最好确定一个统一的基期年份对实际GDP加以调整，这里以 2010 年作为 2012 - 2019 年的基年，即需要将 2016 - 2018 年的 GDP 数据调整为以 2010 年为基年。   

根据基期计算实际 GDP 的公式为： 

$$当季实际 GDP = 基期名义GDP \; \times \frac{当季GDP指数(相对于基期)}{基期GDP指数} $$

导入 GDP 指数数据：

```{r, message = F}
index <- read_excel("data/gdp.xlsx",sheet = 2) %>% select(1, 2)
index$Season <- rev(index$Season)
index$Index <- rev(index$Index) / 100   ## 除 100 便于之后计算

knitr::kable(head(index))
```

这里的 `Index` 可以看做是上面公式中的 $当季GDP指数(相对于基期) \;/\; 基期GDP指数$，但是这里的基期是当年的前一年，故需要转换为相对于 2010 年对应季度的 GDP 指数比。若某年第一季度相对于去年第一季度的 GDP 指数比为 $x$，去年第一季度相对于前年第一季度的 GDP 指数比为 $y$，则某年第一季度相对于前年第一季度的 GDP 指数比为 $x \times y$，以此类推可求得 2016 - 2018 年各季度相对于 2010 年各季度的 GDP 指数比。


```{r}
index$group <- rep(1:4, 8)
index <- index %>%
  group_by(group) %>%
  mutate(Index = cumprod(Index))  ## 此时 Index 变为相对于 2010 年季度的 GDP 指数
knitr::kable(index)
```


2010 年四个季度的名义 GDP 分别为：87501.3、99347.4、105963.7、119306.8  

```{r}
## 将 gdp 数据中 2016-2018年的 GDP 调整为以 2010 年为基年 
index$GDP <- round(index$Index * c(87501.3, 99347.4, 105963.7, 119306.8), 1)
gdp$GDP[17:28] <- index$GDP[21:32]
knitr::kable(gdp)
```



下面可以开始计算增长率。因环比增长率需要季度调整，这里只计算同比增长率，公式为：

$$同比增长率 = \frac{本季值 - 去年同期值}{去年同期值} \times 100 \% $$

表中共有 `r length(gdp$GDP)` 个季度的 GDP 指标，可以计算 `r length(gdp$GDP) - 4` 个季度的同比增长率


```{r}
## 定义计算同比增长率的函数
rate_1 <- function(x) {
  rate = numeric(length(x))
  for (i in seq(5, length(x))) {
    rate[i] = (x[i] - x[i - 4]) / x[i - 4] * 100
  }
  for (i in seq(1, 4)) {
    rate[i] <- NA
  }
  rate
}
```


```{r}
## 计算同比增长率
gdp <- gdp %>%
  mutate(rate = round(rate_1(GDP), 1))
DT::datatable(gdp, 
              rownames = F, 
              filter = "top", 
              options = list(pageLength = 8))
```

折线图：  

```{r, dev = "png", dpi = 300, warning = F}
## 绘图
library(ggrepel)
ggplot(gdp,aes(Season, rate)) +
  geom_line(aes(group = 1)) +
  geom_point(shape = 21, fill = "skyblue", size = 3) +
  geom_text_repel(aes(label = rate), size = 3) +
  scale_y_continuous(labels = function(x) paste(x, "%")) + 
  labs(x = NULL, y = NULL, 
       title = "Seasonal GDP Growth of China (year-on-year)",
       subtitle = "2012-2019") + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1),
        panel.grid.major.x = element_blank(),
        axis.text.y = element_text(size = 12))
```



